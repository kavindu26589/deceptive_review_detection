<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Deceptive Review Detection</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen flex items-center justify-center">

    <div class="bg-white shadow-lg rounded-lg p-6 w-full max-w-xl">
        <h1 class="text-2xl font-bold mb-4 text-gray-800">
            Deceptive Review Detection
        </h1>

        <textarea id="review" class="w-full border rounded p-3 mb-4 focus:outline-none focus:ring" rows="5"
            placeholder="Paste a product review here..."></textarea>

        <button onclick="analyze()" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition">
            Analyze Review
        </button>

        <!-- Result Card -->
        <div id="result" class="mt-6 hidden">
            <div id="resultCard" class="p-4 rounded-lg border">
                <div class="flex items-center justify-between mb-2">
                    <h2 class="text-lg font-semibold">Analysis Result</h2>
                    <span id="badge" class="px-3 py-1 rounded-full text-sm font-semibold"></span>
                </div>

                <!-- Confidence -->
                <div class="mb-3">
                    <div class="text-sm mb-1 text-gray-600">Confidence</div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="confidenceBar" class="h-2 rounded-full"></div>
                    </div>
                </div>

                <!-- Explanation -->
                <div class="mb-3">
                    <div class="text-sm font-semibold mb-1 text-gray-700">Explanation</div>
                    <p id="explanation" class="text-sm text-gray-800"></p>
                </div>

                <!-- Contradiction Pairs -->
                <div id="pairsSection" class="hidden">
                    <div class="text-sm font-semibold mb-1 text-gray-700">
                        Contradicting Statements
                    </div>
                    <ul id="pairs" class="text-sm list-disc pl-5 space-y-1"></ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function analyze() {
            const text = document.getElementById("review").value;
            const resultDiv = document.getElementById("result");
            const badge = document.getElementById("badge");
            const explanation = document.getElementById("explanation");
            const confidenceBar = document.getElementById("confidenceBar");
            const resultCard = document.getElementById("resultCard");
            const pairsSection = document.getElementById("pairsSection");
            const pairsList = document.getElementById("pairs");

            resultDiv.classList.remove("hidden");
            explanation.textContent = "Analyzing...";
            pairsSection.classList.add("hidden");
            pairsList.innerHTML = "";

            const res = await fetch("/analyze", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ text })
            });

            const data = await res.json();

            const confidence = Math.round((data.confidence || 0) * 100);

            // Badge + colors
            if (data.has_contradiction) {
                badge.textContent = "Contradiction Detected";
                badge.className = "px-3 py-1 rounded-full text-sm font-semibold bg-red-100 text-red-700";
                resultCard.className = "p-4 rounded-lg border border-red-300 bg-red-50";
                confidenceBar.className = "h-2 rounded-full bg-red-500";
            } else {
                badge.textContent = "No Contradiction";
                badge.className = "px-3 py-1 rounded-full text-sm font-semibold bg-green-100 text-green-700";
                resultCard.className = "p-4 rounded-lg border border-green-300 bg-green-50";
                confidenceBar.className = "h-2 rounded-full bg-green-500";
            }

            confidenceBar.style.width = confidence + "%";
            explanation.textContent = data.explanation || "No explanation provided.";

            // Contradicting pairs
            if (data.pairs && data.pairs.length > 0) {
                pairsSection.classList.remove("hidden");
                data.pairs.forEach(pair => {
                    const li = document.createElement("li");
                    li.textContent = `“${pair[0]}” ↔ “${pair[1]}”`;
                    pairsList.appendChild(li);
                });
            }
        }
    </script>

</body>

</html>
